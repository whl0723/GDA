function phi=wy3(I1,I2,I3,fl,fh)
I11=Complex_GaussianFilter1(I1,fl,fh);
I22=Complex_GaussianFilter1(I2,fl,fh);
I33=Complex_GaussianFilter1(I3,fl,fh);
Ir1=real(I11);
Ii1=imag(I11);
Ir2=real(I22);
Ii2=imag(I22);
Ir3=real(I33);
Ii3=imag(I33);
C=[sum(sum(Ir2.^2))+sum(sum(Ii2.^2)),sum(sum(Ii3.*Ii2))+sum(sum(Ir3.*Ir2));sum(sum(Ir3.*Ir2))+sum(sum(Ii3.*Ii2)),sum(sum(Ir3.^2))+sum(sum(Ii3.^2))];
E=eye(2);
C1=C\E;
K=[sum(sum(Ir1.*Ir2))+sum(sum(Ii1.*Ii2));sum(sum(Ir1.*Ir3))+sum(sum(Ii1.*Ii3))];
K=C1*K;
d2=acos((K(2)^2-K(1)^2+1)/(2*K(2)));
d1=acos((K(1)^2-K(2)^2+1)/(2*K(1)));
% d2sin=(-K(1)*sin(d1))/K(2);
% d2cos=(K(2)^2-K(1)^+1)/(2*K(2));
% d2=atan2(d2sin,d2cos);
Ip1=(I1-I2)/sin(d1/2);
Ip2=(I1-I3)/sin(d2/2);
phi=atan2(real(Ip1*sin(d2/2-d1/2)),real(Ip2-Ip1*cos(d2/2-d1/2)));
% phi=unwrap2(phi);